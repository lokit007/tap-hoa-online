<strong id="tittle"><%= __('branch-tittle') %></strong>
<% if(session.jurisdiction < 2) { %>
<form action="#" name='f-update' method="POST" autocomplete="on">
    <input type="hidden" 
        id="key" name="key" 
        value="-1" />
    <input type="text" 
        id="name" name="namebranch" 
        class="search-control form-control ctr-1x" 
        data="branch" 
        title="<%= __('branch-input-search-tittle') %>" 
        placeholder="<%= __('branch-input-search-placeholder') %>" />
    <input type="text" 
        id="address" name="addressbranch"
        class="form-control ctr-1x" 
        title="<%= __('branch-input-address-tittle') %>" 
        placeholder="<%= __('branch-input-address-placeholder') %>" />
    <div>
        <div class="ctr-3x">
            <input type="tel" 
                id="phone" name="phonebranch" maxlength="11" 
                class="form-control" 
                title="<%= __('branch-input-phone-tittle') %>" 
                placeholder="<%= __('branch-input-phone-placeholder') %>" />
        </div>
        <div class="ctr-3x">
            <input type="email" 
                id="email" name="emailbranch" maxlength="30"
                class="form-control" 
                title="<%= __('branch-input-email-tittle') %>" 
                placeholder="<%= __('branch-input-email-placeholder') %>" />
        </div>
        <div class="ctr-3x">
            <input type="text" 
                id="fax" name="faxbranch" maxlength="11" 
                class="form-control" 
                title="<%= __('branch-input-fax-tittle') %>" 
                placeholder="<%= __('branch-input-fax-placeholder') %>" />
        </div>    
        <div class="ctr-3x" style="float: right !important; margin-right: 10px;">
            <span id="chitiet" class="fa-stack fa-lg" style="cursor: pointer;" title="<%= __('branch-button-info-tittle') %>">
                <i class="fa fa-square-o fa-stack-2x"></i>
                <i class="fa fa-info fa-stack-1x"></i>
            </span>
        </div>
        <div class="d-clear"></div>
    </div>
    <button type="button" id="delete" class="btn btn-danger btn-sm ctr-btn" disabled>
        <i class="fa fa-trash-o" aria-hidden="true"></i> <%= __('branch-button-delete-tittle') %>
    </button>
    <button type="submit" id="update" class="btn btn-success btn-sm ctr-btn" disabled>
        <i class="fa fa-check" aria-hidden="true"></i> <%= __('branch-button-update-tittle') %>
    </button>
    <button type="submit" id="add" class="btn btn-primary btn-sm ctr-btn">
        <i class="fa fa-plus" aria-hidden="true"></i> <%= __('branch-button-add-tittle') %>
    </button>
</form>
<div id="view" class="d-clear"></div>
<div class="table-responsive d-table" id="d-fixheight">
    <table class="table table-hover table-condensed table-striped">
        <thead>
        <tr>
            <th>#</td>
            <th><%= __('branch-table-name-tittle') %></th>
            <th><%= __('branch-table-address-tittle') %></th>
            <th><%= __('branch-table-email-tittle') %></th>
            <th></th>
        </tr>
        </thead>
        <tbody>
        <% for(i=0; i<data.length; i++) { %>
        <tr onclick="infobranch('<%= data[i].id %>');">
            <td><%= data[i].id %></td>
            <td><%= data[i].name %></td>
            <td><%= data[i].address %></td>
            <td class="col-phone"><%= data[i].phone %></td>
            <td class="col-action">
                <i class="fa fa-phone-square ctr-action" aria-hidden="true" 
                    onclick="window.location.href = 'mailto:<%= data[i].phone %>';"
                    title="<%= __('branch-table-icon-phone') %>"></i>
                <i class="fa fa-envelope ctr-action" aria-hidden="true" 
                    onclick="window.location.href = 'tel:<%= data[i].email %>';"
                    title="<%= __('branch-table-icon-email') %>"></i>
                <i class="fa fa-trash ctr-action" aria-hidden="true"
                    onclick="deletebranch('<%= data[i].id %>');" 
                    title="<%= __('branch-table-icon-delete') %>"></i>
            </td>
        </tr>
       <% } %>
        </tbody>
        <tfoot>
            <tr>
                <td colspan="5" id="viewmore" onclick="searchbranch()">
                    <i class="fa fa-angle-double-down" aria-hidden="true"></i> <%= __('branch-table-icon-view') %>
                </td>
            </tr>
        </tfoot>
    </table>
</div>
<% } %>

<script>
    $(document).ready(function(){
        $("#add").click(function(){
            $("#key").val("-1");
        });
        // check validate
        $("form[name='f-update']").validate({
            rules : {
                namebranch: "required",
                addressbranch: 'required',
                phonebranch: {
                    required: true,
                    digits: true,
                    minlength: 10,
                    maxlength: 20,
                }
            },
            messages : {
                namebranch: <%= __('branch-input-error') %>,
                addressbranch: <%= __('branch-input-error') %>,
                phonebranch: {
                    required: <%= __('branch-input-error') %>,
                    digits: "Hãy nhập số điện thoại!",
                    minlength: "Hãy nhập số điện thoại!",
                    maxlength: "Hãy nhập số điện thoại!",
                }
            },
            submitHandler : function(form) {
                // form.submit();
                if($("#key").val() == "-1")
                    updatebranch(true);
                else
                    updatebranch(false);
            }
        });
    });
</script>
